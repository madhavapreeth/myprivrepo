CREATE TRIGGER MY_TRIGGER
AFTER INSERT ON CUSTOMER
FOR EACH ROW
INSERT INTO CUSTOMER_HISTORY(C_ID,C_NAME,C_PREV_NAME,ORDER_ITEM,PREV_ORDER,ADDRESS,PREV_ADDRESS,STARTING_DATE,ENDING_DATE,INDICATOR,S_KEY)
VALUES(NEW.C_ID,NEW.C_NAME,'--',NEW.ORDER_ITEM,'--',NEW.ADDRESS,'--',NOW(),NULL,'Y',NEW.UPDATIONS);



CREATE TRIGGER MY_TRIGGER2
BEFORE UPDATE ON CUSTOMER
FOR EACH ROW
 SET NEW.UPDATIONS=OLD.UPDATIONS+1 


DELIMITER $$
CREATE TRIGGER trigger3
AFTER update ON CUSTOMER
FOR EACH ROW
BEGIN
  UPDATE CUSTOMER_HISTORY
  SET ENDING_DATE = STARTING_DATE-1, INDICATOR = 'N'
  WHERE C_ID = OLD.C_ID AND INDICATOR = 'Y'; 
END $$
DELIMITER ;















CREATE  TRIGGER TRIGGER7
AFTER UPDATE ON CUSTOMER
FOR EACH ROW
INSERT INTO CUSTOMER_HISTORY(C_ID,C_NAME,C_PREV_NAME,ORDER_ITEM,PREV_ORDER,ADDRESS,PREV_ADDRESS,STARTING_DATE,ENDING_DATE,INDICATOR,S_KEY)
VALUES(OLD.C_ID,NEW.C_NAME,OLD.C_NAME,NEW.ORDER_ITEM,OLD.ORDER_ITEM,NEW.ADDRESS,OLD.ADDRESS,NOW(),NULL,'Y',NEW.UPDATIONS)


DELIMITER $$
CREATE TRIGGER trigger4
AFTER update ON CUSTOMER
FOR EACH ROW
BEGIN
  UPDATE CUSTOMER_HISTORY
  SET C_PREV_NAME = '-'
  WHERE C_NAME=C_PREV_NAME AND C_ID=OLD.C_ID AND NEW.C_NAME=OLD.C_NAME; 
END $$
DELIMITER ;

DELIMITER $$
CREATE TRIGGER trigger5
AFTER update ON CUSTOMER
FOR EACH ROW
BEGIN
  UPDATE CUSTOMER_HISTORY
  SET PREV_ADDRESS='-'
  WHERE  ADDRESS=PREV_ADDRESS and C_ID = OLD.C_ID  AND NEW.ADDRESS=OLD.ADDRESS;  
END $$
DELIMITER ;

DELIMITER $$
CREATE TRIGGER trigger6
AFTER update ON CUSTOMER
FOR EACH ROW
BEGIN
  UPDATE CUSTOMER_HISTORY
  SET PREV_ORDER='-'
  WHERE ORDER_ITEM=PREV_ORDER and C_ID = OLD.C_ID  AND NEW.ORDER_ITEM=OLD.ORDER_ITEM;  
END $$
DELIMITER ;



C_ID          | int         | YES  |     | NULL    |       |
| C_NAME        | varchar(20) | YES  |     | NULL    |       |
| C_PREV_NAME   | varchar(20) | YES  |     | NULL    |       |
| ORDER_ITEM    | varchar(30) | YES  |     | NULL    |       |
| PREV_ORDER    | varchar(30) | YES  |     | NULL    |       |
| ADDRESS       | varchar(30) | YES  |     | NULL    |       |
| PREV_ADDRESS  | varchar(20) | YES  |     | NULL    |       |
| STARTING_DATE | date        | YES  |     | NULL    |       |
| ENDING_DATE   | date        | YES  |     | NULL    |       |
| INDICATOR     | char(2)     | YES  |     | NULL    |       |
| S_KEY